Implement the following enhancement to the application.  Do the enhancement first.  Follow the Rules and Guidelines for the project.  Plan out you actions.  Work logically through the process.  Be sure to cover all of the instances where the enhancement alters the application.  Handle errors and fallback to seamless solutions.
Log each fix/enhancement as an Issue/Error on Github for the project with the required proper 'bug' documentation.
Be sure the Issue has the proper Assignees, Labels, bug, Something isn't working, critical, etc for the Issue.
If the changes are code related make sure the test cases run to 98% success.  After the resolution of the Issue, close the Issue on GitHub with the proper documentation.
enhancement:


Fix Authentication Bypass Vulnerability
P0 - Critical Security Access Control
File: src/lib/auth-middleware.ts

Issue: Session validation can be bypassed with crafted requests

Impact: Unauthorized access to protected resources

Copy Augment AI Prompt
Fix the authentication bypass vulnerability in src/lib/auth-middleware.ts:

1. Strengthen session validation in validateAndRefreshSession() function
2. Implement proper session token verification with cryptographic signatures
3. Add IP address binding to prevent session hijacking
4. Implement session timeout and automatic renewal
5. Add comprehensive authentication tests

Critical security fixes:
- Line 89: Fix session token validation logic
- Line 134: Add cryptographic session verification
- Line 178: Implement IP address validation
- Line 203: Fix session expiration handling

Security requirements:
- Use JWT with proper signature verification
- Implement session fingerprinting
- Add rate limiting for authentication attempts
- Secure session storage with encryption

Additional protections:
- Implement account lockout after failed attempts
- Add suspicious activity detection
- Log all authentication events
- Implement session invalidation on logout

Testing requirements:
- Test session hijacking scenarios
- Verify IP binding functionality
- Test session timeout behavior
- Validate authentication across all protected routes

