Implement the following enhancement to the application.  Do the enhancement first.  Follow the Rules and Guidelines for the project.  Plan out you actions.  Work logically through the process.  Be sure to cover all of the instances where the enhancement alters the application.  Handle errors and fallback to seamless solutions.
Log each fix/enhancement as an Issue/Error on Github for the project with the required proper 'bug' documentation.
Be sure the Issue has the proper Assignees, Labels, bug, Something isn't working, critical, etc for the Issue.
If the changes are code related make sure the test cases run to 98% success.  After the resolution of the Issue, close the Issue on GitHub with the proper documentation.
enhancement:

API Security Tests

                
API Security Testing PromptCopy

Implement comprehensive API security tests for the business_scraper application. I need you to:

1. Complete the test implementation in src/__tests__/critical/api-security.test.ts
2. Test CSRF protection across all state-changing API endpoints
3. Implement rate limiting tests for all public API endpoints
4. Cover input validation and sanitization for all API inputs
5. Test for common security vulnerabilities (injection attacks, XSS, etc.)

Focus on testing:
- src/lib/csrfProtection.ts - CSRF token generation and validation
- src/lib/rateLimitingService.ts - API rate limiting implementation
- src/lib/validation-middleware.ts - Input validation and sanitization
- src/lib/api-security.ts - General API security utilities
- All API routes for proper security header implementation

Include tests for malicious inputs, rate limit bypass attempts, CSRF token manipulation, and other security attack vectors. Ensure all security middleware is properly tested with both valid and invalid scenarios.