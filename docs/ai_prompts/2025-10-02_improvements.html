<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Augment AI Prompts - Test Coverage Improvement Implementation</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .phase { background: #f5f5f5; margin: 20px 0; padding: 20px; border-radius: 8px; }
        .phase h2 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .prompt { background: #fff; border: 1px solid #ddd; margin: 15px 0; padding: 15px; border-radius: 5px; }
        .prompt h3 { color: #e74c3c; margin-top: 0; }
        .prompt-text { background: #f8f9fa; padding: 15px; border-left: 4px solid #007bff; font-family: monospace; white-space: pre-wrap; }
        .priority { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .critical { background: #dc3545; color: white; }
        .high { background: #fd7e14; color: white; }
        .medium { background: #ffc107; color: black; }
        .header { text-align: center; margin-bottom: 30px; }
        .note { background: #d1ecf1; border: 1px solid #bee5eb; padding: 10px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h1>🤖 Augment AI Prompts for Test Coverage Improvement</h1>
        <p><strong>Business Scraper Application</strong> | Generated: October 2, 2025</p>
        <p>Comprehensive prompts to achieve 95% test coverage through systematic implementation</p>
    </div>

    <div class="note">
        <strong>📋 Usage Instructions:</strong> Copy and paste each prompt into Augment AI to execute the corresponding phase of the test coverage improvement plan. Execute prompts in order for best results.
    </div>

    <div class="phase">
        <h2>🔧 Phase 0: Infrastructure Fixes (Week 1) <span class="priority critical">CRITICAL</span></h2>
        <p><strong>Objective:</strong> Resolve infrastructure issues preventing test execution</p>

        <div class="prompt">
            <h3>1. Fix CORS/JSDOM Configuration</h3>
            <div class="prompt-text">Fix the CORS and JSDOM configuration issues in the business_scraper test environment. I need you to:

1. Analyze the current Jest setup in jest.setup.js and identify CORS-related configuration issues
2. Fix the JSDOM configuration to properly handle localhost requests during testing
3. Update the test environment to prevent "Cross origin http://localhost forbidden" errors
4. Ensure XMLHttpRequest mocking works correctly for API testing
5. Test the fixes by running a sample API test to verify CORS issues are resolved

Focus on:
- Configuring JSDOM to allow cross-origin requests for localhost
- Updating fetch and XMLHttpRequest mocking
- Ensuring proper test isolation for API calls
- Validating that existing tests can make HTTP requests without CORS errors

The goal is to eliminate all CORS-related test failures and enable proper API testing.</div>
        </div>

        <div class="prompt">
            <h3>2. Resolve Test Timeout Issues</h3>
            <div class="prompt-text">Resolve test timeout issues in the business_scraper application. I need you to:

1. Analyze failing tests that exceed timeout limits (currently many tests timing out)
2. Identify performance bottlenecks in test execution
3. Optimize test performance by improving mocking strategies
4. Adjust timeout configurations appropriately for different test types
5. Implement proper test cleanup to prevent hanging processes

Specific areas to address:
- Browser pool load tests failing due to timeouts
- Performance tests exceeding 30-second limits
- Memory-intensive operations causing delays
- Streaming connection tests hanging
- Integration tests with external service calls

Configure appropriate timeouts:
- Unit tests: 5-10 seconds
- Integration tests: 15-30 seconds  
- Performance tests: 60-120 seconds
- E2E tests: 180 seconds

Ensure all tests complete within reasonable time limits while maintaining reliability.</div>
        </div>

        <div class="prompt">
            <h3>3. Fix Browser Pool Mocking</h3>
            <div class="prompt-text">Fix the browser pool mocking issues in the business_scraper test suite. I need you to:

1. Analyze the current browser pool implementation in src/lib/browserPool.ts
2. Review and fix the browser pool mocking in src/__tests__/mocks/optimized-browser-pool.mock.ts
3. Resolve browser pool load test failures (currently 32% success rate vs 80% target)
4. Fix Puppeteer and browser-related test failures
5. Improve test isolation for browser pool operations

Key issues to address:
- "No available browser capacity" errors in tests
- Browser pool memory leak detection
- Proper cleanup of browser instances in tests
- Mock reliability for concurrent browser operations
- Performance test failures related to browser pool

Ensure the browser pool mocking:
- Properly simulates browser acquisition and release
- Handles concurrent requests reliably
- Provides consistent performance metrics
- Cleans up resources properly after tests
- Supports the expected load testing scenarios

The goal is to achieve >80% success rate in browser pool load tests.</div>
        </div>

        <div class="prompt">
            <h3>4. Enhance Mock Reliability</h3>
            <div class="prompt-text">Enhance the reliability of mocking throughout the business_scraper test suite. I need you to:

1. Standardize mocking patterns across all test files
2. Fix WebSocket and EventSource mocking issues causing connection test failures
3. Improve external service mocking (APIs, databases, third-party services)
4. Implement consistent mock cleanup between tests
5. Create reusable mock utilities and factories

Focus areas:
- WebSocket mocking for streaming functionality
- EventSource mocking for real-time updates
- Database connection mocking
- External API service mocking (Stripe, geocoding, etc.)
- File system and upload mocking

Create standardized mock patterns for:
- HTTP requests and responses
- Database operations
- Real-time connections
- File operations
- External service integrations

Ensure all mocks:
- Reset properly between tests
- Provide consistent behavior
- Support both success and error scenarios
- Are easily configurable for different test cases
- Don't leak state between test runs

The goal is to eliminate mock-related test failures and improve test reliability.</div>
        </div>
    </div>

    <div class="phase">
        <h2>🔒 Phase 1: Critical Security & Payment Testing (Weeks 2-3) <span class="priority high">HIGH</span></h2>
        <p><strong>Objective:</strong> Achieve 100% coverage for authentication and payment modules</p>

        <div class="prompt">
            <h3>5. Authentication System Testing</h3>
            <div class="prompt-text">Implement comprehensive testing for the authentication system in business_scraper. I need you to:

1. Create complete test coverage for src/app/api/auth route handlers
2. Test src/lib/auth.ts authentication functions thoroughly
3. Implement security testing for src/lib/auth-middleware.ts
4. Test CSRF protection in src/hooks/useCSRFProtection.ts
5. Achieve 100% coverage for all authentication-related modules

Test scenarios to implement:
- User login/logout workflows
- Session management and validation
- Password hashing and verification
- Token generation and validation
- Authentication middleware functionality
- CSRF token generation and validation
- Rate limiting for authentication endpoints
- Security headers and cookie settings

Security test cases:
- Invalid credentials handling
- Session hijacking prevention
- Brute force attack protection
- SQL injection prevention in auth queries
- XSS prevention in auth responses
- Proper error message handling (no information leakage)

Create tests for:
- Unit tests for individual auth functions
- Integration tests for complete auth flows
- Security tests for vulnerability scenarios
- Performance tests for auth under load

Ensure all authentication security measures are thoroughly tested and validated.</div>
        </div>

        <div class="prompt">
            <h3>6. Payment Processing Testing</h3>
            <div class="prompt-text">Implement comprehensive testing for payment processing in business_scraper. I need you to:

1. Create complete test coverage for src/app/api/payments route handlers
2. Test src/controller/paymentController.ts payment logic thoroughly
3. Implement testing for Stripe webhook handling in src/app/api/webhooks/stripe
4. Test payment security and validation measures
5. Achieve 100% coverage for all payment-related modules

Payment test scenarios:
- Payment intent creation and confirmation
- Subscription management workflows
- Billing portal access
- Payment history retrieval
- Stripe webhook event processing
- Payment failure handling
- Refund processing
- Currency and amount validation

Security test cases:
- Payment data sanitization
- Stripe signature validation
- PCI compliance measures
- Payment amount validation
- Unauthorized payment prevention
- Payment method security
- Webhook replay attack prevention

Integration tests:
- End-to-end payment flows
- Stripe API integration testing
- Database payment record validation
- Email notification testing
- Error recovery scenarios

Mock Stripe services properly:
- Payment intents
- Webhooks
- Customer objects
- Subscription objects
- Error responses

Ensure all payment processing is secure, reliable, and thoroughly tested.</div>
        </div>

        <div class="prompt">
            <h3>7. Security Vulnerability Testing</h3>
            <div class="prompt-text">Implement comprehensive security vulnerability testing for business_scraper. I need you to:

1. Create security tests for src/lib/api-security.ts
2. Test CSRF protection across all state-changing endpoints
3. Implement rate limiting validation tests
4. Test input validation and sanitization
5. Create penetration testing scenarios

Security test categories:
- Authentication and authorization testing
- Input validation and injection prevention
- Cross-site scripting (XSS) prevention
- Cross-site request forgery (CSRF) protection
- SQL injection prevention
- File upload security
- API rate limiting
- Session security

Specific vulnerability tests:
- SQL injection attempts on all database queries
- XSS payload testing in user inputs
- CSRF token bypass attempts
- Rate limiting bypass testing
- File upload malicious payload testing
- Authentication bypass attempts
- Authorization escalation testing
- Session fixation and hijacking tests

Create automated security test suites:
- OWASP Top 10 vulnerability testing
- API security testing
- Input fuzzing tests
- Authentication security tests
- Data validation security tests

Ensure comprehensive security coverage:
- All user inputs are validated and sanitized
- All endpoints have proper authentication/authorization
- All state-changing operations require CSRF tokens
- Rate limiting is properly enforced
- Security headers are correctly set

The goal is to identify and prevent all common security vulnerabilities.</div>
        </div>
    </div>

    <div class="phase">
        <h2>⚙️ Phase 2: Core Business Logic (Weeks 4-6) <span class="priority medium">MEDIUM</span></h2>
        <p><strong>Objective:</strong> Achieve 95% coverage for API endpoints and business logic</p>

        <div class="prompt">
            <h3>8. API Endpoint Testing</h3>
            <div class="prompt-text">Implement comprehensive testing for all API endpoints in business_scraper. I need you to:

1. Create complete test coverage for all routes in src/app/api/
2. Test request/response validation for each endpoint
3. Implement error handling scenario testing
4. Test API middleware and security measures
5. Achieve 95% coverage for all API endpoints

API endpoints to test comprehensively:
- /api/auth/* - Authentication endpoints
- /api/businesses/* - Business data endpoints  
- /api/scrape/* - Web scraping endpoints
- /api/search/* - Search functionality
- /api/export/* - Data export endpoints
- /api/analytics/* - Analytics endpoints
- /api/health/* - Health check endpoints
- /api/upload/* - File upload endpoints

Test scenarios for each endpoint:
- Valid request handling
- Invalid request validation
- Authentication/authorization checks
- Rate limiting enforcement
- Input sanitization
- Output validation
- Error response formatting
- HTTP status code accuracy

Integration testing:
- Database operations
- External service calls
- File system operations
- Cache interactions
- Background job triggering

Performance testing:
- Response time validation
- Concurrent request handling
- Large payload processing
- Memory usage monitoring

Create comprehensive test suites that validate all API functionality and ensure robust error handling.</div>
        </div>
    </div>

        <div class="prompt">
            <h3>9. Business Rule Validation Testing</h3>
            <div class="prompt-text">Implement comprehensive testing for business logic validation in business_scraper. I need you to:

1. Test all business rules in src/model/ and src/controller/ directories
2. Validate data processing workflows and transformations
3. Test business logic constraints and validations
4. Implement edge case and boundary testing
5. Achieve 95% coverage for core business logic

Business logic areas to test:
- Data validation rules for business information
- Search algorithm logic and ranking
- Data enrichment and processing workflows
- Export format generation and validation
- Analytics calculation logic
- Subscription and billing business rules
- User permission and access control logic

Test scenarios:
- Valid data processing workflows
- Invalid data handling and error recovery
- Boundary conditions and edge cases
- Business rule constraint enforcement
- Data transformation accuracy
- Calculation logic verification
- Workflow state management

Create comprehensive test suites for:
- Data model validation
- Business process workflows
- Calculation and algorithm logic
- State management and transitions
- Error handling and recovery

Ensure all business rules are properly tested and validated.</div>
        </div>

        <div class="prompt">
            <h3>10. Service Integration Testing</h3>
            <div class="prompt-text">Implement comprehensive service integration testing for business_scraper. I need you to:

1. Test integration between internal services and modules
2. Validate external service integrations (APIs, databases)
3. Test data flow between different system components
4. Implement end-to-end workflow testing
5. Achieve 95% coverage for service integration scenarios

Integration areas to test:
- Database service integration
- External API service integration (geocoding, business data)
- File storage service integration
- Email service integration
- Cache service integration
- Search engine integration
- Analytics service integration

Test scenarios:
- Service-to-service communication
- Data consistency across services
- Error propagation and handling
- Service failure recovery
- Transaction management
- Async operation handling
- Service dependency management

Create integration test suites for:
- Database operations and transactions
- External API calls and responses
- File upload and storage workflows
- Email notification systems
- Cache invalidation and updates
- Search indexing and retrieval

Mock external services appropriately while testing real integration logic.</div>
        </div>
    </div>

    <div class="phase">
        <h2>🎨 Phase 3: UI & Performance (Weeks 7-8) <span class="priority medium">MEDIUM</span></h2>
        <p><strong>Objective:</strong> Achieve 90% coverage for UI components and establish performance baselines</p>

        <div class="prompt">
            <h3>11. React Component Testing</h3>
            <div class="prompt-text">Implement comprehensive React component testing for business_scraper. I need you to:

1. Create complete test coverage for all React components in src/components/
2. Test custom hooks in src/hooks/
3. Implement user interaction testing
4. Test component state management and props
5. Achieve 90% coverage for UI components

Component testing areas:
- Form components and validation
- Data display components (tables, cards, lists)
- Navigation and routing components
- Modal and dialog components
- Search and filter components
- Dashboard and analytics components
- File upload components

Test scenarios for each component:
- Rendering with different props
- User interaction handling (clicks, inputs, selections)
- State changes and updates
- Error state handling
- Loading state management
- Responsive behavior
- Accessibility features

Custom hooks testing:
- Hook state management
- Effect handling and cleanup
- Custom logic validation
- Error handling in hooks
- Performance optimization

Testing patterns to implement:
- Unit tests for individual components
- Integration tests for component interactions
- Snapshot testing for UI consistency
- User event simulation
- Mock external dependencies

Use React Testing Library best practices for user-centric testing.</div>
        </div>

        <div class="prompt">
            <h3>12. Accessibility Compliance Testing</h3>
            <div class="prompt-text">Implement comprehensive accessibility testing for business_scraper. I need you to:

1. Test WCAG 2.1 AA compliance across all UI components
2. Implement keyboard navigation testing
3. Test screen reader compatibility
4. Validate color contrast and visual accessibility
5. Achieve 90% accessibility test coverage

Accessibility testing areas:
- Semantic HTML structure
- ARIA labels and roles
- Keyboard navigation support
- Focus management
- Color contrast ratios
- Alternative text for images
- Form accessibility
- Error message accessibility

Test scenarios:
- Keyboard-only navigation
- Screen reader compatibility
- High contrast mode support
- Zoom functionality (up to 200%)
- Focus indicator visibility
- Form validation accessibility
- Dynamic content announcements

Automated accessibility testing:
- axe-core integration for automated checks
- Color contrast validation
- HTML semantic validation
- ARIA attribute validation
- Keyboard trap detection

Manual accessibility testing:
- Screen reader testing (NVDA, JAWS, VoiceOver)
- Keyboard navigation testing
- Voice control testing
- Mobile accessibility testing

Create comprehensive accessibility test suites that ensure the application is usable by all users.</div>
        </div>

        <div class="prompt">
            <h3>13. Performance Baseline Establishment</h3>
            <div class="prompt-text">Establish comprehensive performance baselines and testing for business_scraper. I need you to:

1. Implement performance testing for critical user journeys
2. Establish baseline metrics for key operations
3. Create load testing scenarios
4. Implement performance regression testing
5. Set up automated performance monitoring

Performance testing areas:
- Page load times and rendering performance
- API response times under various loads
- Database query performance
- Search functionality performance
- Data export performance
- File upload performance
- Real-time feature performance

Load testing scenarios:
- Concurrent user simulation
- High-volume data processing
- Peak traffic simulation
- Stress testing for breaking points
- Endurance testing for memory leaks

Performance metrics to track:
- Response times (p50, p95, p99)
- Throughput (requests per second)
- Memory usage and garbage collection
- CPU utilization
- Database connection pooling
- Cache hit rates
- Error rates under load

Create performance test suites:
- Unit performance tests for critical functions
- Integration performance tests for workflows
- Load tests for scalability validation
- Stress tests for reliability validation
- Endurance tests for stability validation

Establish performance budgets and alerts for regression detection.</div>
        </div>
    </div>

    <div class="phase">
        <h2>🔄 Automation & Monitoring Setup</h2>
        <p><strong>Objective:</strong> Establish automated testing and monitoring systems</p>

        <div class="prompt">
            <h3>14. Test Automation Strategy Implementation</h3>
            <div class="prompt-text">Implement comprehensive test automation for business_scraper. I need you to:

1. Set up automated test execution in CI/CD pipeline
2. Configure coverage gates and quality checks
3. Implement automated test generation for new modules
4. Set up performance monitoring and alerting
5. Create automated reporting and dashboards

CI/CD Integration:
- Configure GitHub Actions for automated testing
- Set up coverage reporting and gates
- Implement quality checks and linting
- Configure automated security scanning
- Set up deployment testing workflows

Test Automation Features:
- Automated test template generation
- Test data factory creation
- Mock service automation
- Test environment provisioning
- Parallel test execution optimization

Monitoring and Alerting:
- Coverage trend monitoring
- Performance regression detection
- Test failure alerting
- Quality metric tracking
- Automated report generation

Create automation tools for:
- New module test scaffolding
- Test data generation
- Mock service management
- Coverage analysis automation
- Performance baseline tracking

Ensure the automation system supports continuous quality improvement.</div>
        </div>

        <div class="prompt">
            <h3>15. Final Validation & Documentation</h3>
            <div class="prompt-text">Perform final validation and create comprehensive documentation for the test coverage implementation. I need you to:

1. Validate that all coverage targets have been achieved
2. Perform comprehensive system testing
3. Create documentation for the testing strategy
4. Establish maintenance procedures
5. Provide training materials for the team

Final Validation Checklist:
- Overall coverage ≥95% achieved
- Security modules at 100% coverage
- Payment modules at 100% coverage
- All infrastructure issues resolved
- Performance baselines established
- Accessibility compliance verified

System Testing:
- End-to-end workflow validation
- Cross-browser compatibility testing
- Mobile responsiveness testing
- Performance under load validation
- Security vulnerability assessment
- Accessibility compliance verification

Documentation Creation:
- Testing strategy documentation
- Test execution procedures
- Coverage maintenance guidelines
- Performance monitoring setup
- Security testing protocols
- Accessibility testing procedures

Training Materials:
- Testing best practices guide
- Mock service usage documentation
- Performance testing procedures
- Security testing guidelines
- Accessibility testing training

Maintenance Procedures:
- Regular coverage review process
- Performance baseline updates
- Security test updates
- Test infrastructure maintenance
- Quality metric monitoring

Ensure the testing system is sustainable and maintainable long-term.</div>
        </div>
    </div>

    <div class="phase">
        <h2>📊 Progress Tracking & Validation</h2>
        <p>Use these prompts to track progress and validate completion:</p>

        <div class="prompt">
            <h3>Progress Assessment</h3>
            <div class="prompt-text">Run the enhanced test coverage analysis to track progress. Execute:

```bash
node scripts/test-coverage-improvement.js
```

Then analyze the results and provide:
1. Current coverage percentages by category
2. Remaining gaps and priorities
3. Infrastructure issues resolved
4. Next phase readiness assessment
5. Updated timeline if needed

Compare results against the baseline and adjust the implementation plan as needed.</div>
        </div>

        <div class="prompt">
            <h3>Final Coverage Validation</h3>
            <div class="prompt-text">Perform final validation of test coverage achievement. I need you to:

1. Run comprehensive coverage analysis
2. Validate all targets have been met
3. Verify test quality and reliability
4. Confirm automation is working
5. Generate final completion report

Validation Checklist:
□ Overall coverage ≥95%
□ Security modules 100% coverage
□ Payment modules 100% coverage
□ UI components ≥90% coverage
□ All tests passing consistently
□ Performance baselines established
□ Accessibility compliance verified
□ Automation systems operational
□ Documentation complete
□ Team training completed

Generate a comprehensive completion report documenting:
- Final coverage metrics
- Quality improvements achieved
- Infrastructure issues resolved
- Performance improvements
- Security enhancements
- Accessibility improvements
- Automation benefits
- Maintenance procedures established

Celebrate the achievement of comprehensive test coverage!</div>
        </div>
    </div>

    <div class="phase">
        <h2>📚 Additional Resources</h2>
        <div class="note">
            <strong>🔗 Reference Links:</strong>
            <ul>
                <li><strong>Coverage Analysis:</strong> docs/enhanced-coverage-analysis.json</li>
                <li><strong>Test Plan:</strong> docs/enhanced-test-coverage-plan.json</li>
                <li><strong>Infrastructure Report:</strong> docs/TEST_INFRASTRUCTURE_ANALYSIS.md</li>
                <li><strong>Summary Report:</strong> docs/COVERAGE_ANALYSIS_SUMMARY.md</li>
                <li><strong>Automation Script:</strong> scripts/test-coverage-improvement.js</li>
            </ul>
        </div>

        <div class="note">
            <strong>⚡ Quick Commands:</strong>
            <ul>
                <li><code>npm run test:coverage</code> - Run coverage analysis</li>
                <li><code>npm run test:security</code> - Run security tests</li>
                <li><code>npm run test:performance</code> - Run performance tests</li>
                <li><code>npm run test:accessibility</code> - Run accessibility tests</li>
                <li><code>node scripts/test-coverage-improvement.js</code> - Generate gap analysis</li>
            </ul>
        </div>

        <div class="note">
            <strong>🎯 Success Metrics:</strong>
            <ul>
                <li>Lines Coverage: 95%+ (Current: 4.93%)</li>
                <li>Statements Coverage: 95%+ (Current: 4.84%)</li>
                <li>Functions Coverage: 95%+ (Current: 4.49%)</li>
                <li>Branches Coverage: 95%+ (Current: 3.74%)</li>
                <li>Security Modules: 100% Coverage</li>
                <li>Payment Modules: 100% Coverage</li>
                <li>All Tests Passing: 100%</li>
                <li>Performance Baselines: Established</li>
            </ul>
        </div>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding: 20px; border-top: 1px solid #ddd;">
        <p><strong>Generated by Augment AI</strong> | October 2, 2025</p>
        <p>Business Scraper Test Coverage Improvement Implementation Guide</p>
        <p><em>Execute prompts sequentially for optimal results</em></p>
    </footer>

</body>
</html>
