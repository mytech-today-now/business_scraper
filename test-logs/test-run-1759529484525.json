{"timestamp":"2025-10-03T22:11:26.184Z","suite":"Auth-security-comprehensive","testCase":"should not expose session IDs in any response","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[SESSION_ACTIVE]\"\u001b[39m\nReceived: \u001b[31mundefined\u001b[39m\n    at Object.toBe (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:239:38)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
{"timestamp":"2025-10-03T22:11:26.194Z","suite":"Auth-security-comprehensive","testCase":"should use secure session creation","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m\"[SESSION_CREATED]\"\u001b[39m\nReceived: \u001b[31mundefined\u001b[39m\n    at Object.toBe (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:276:38)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
{"timestamp":"2025-10-03T22:11:26.198Z","suite":"Auth-security-comprehensive","testCase":"should sanitize sensitive data in logs","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m[Error: Database connection failed: password=secret123, token=abc123]\u001b[39m, \u001b[32m\"Auth Request Processing\"\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:368:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
{"timestamp":"2025-10-03T22:11:26.203Z","suite":"Auth-security-comprehensive","testCase":"should handle password verification failures securely","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoBe\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // Object.is equality\u001b[22m\n\nExpected: \u001b[32m500\u001b[39m\nReceived: \u001b[31m401\u001b[39m\n    at Object.toBe (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:501:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
{"timestamp":"2025-10-03T22:11:26.210Z","suite":"Auth-security-comprehensive","testCase":"should set secure cookie attributes","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32mObjectContaining {\"sessionId\": \"[SESSION_CREATED]\", \"success\": true}\u001b[39m, \u001b[32m200\u001b[39m, \u001b[32mObjectContaining {\"context\": \"Auth Login Success\", \"sanitizeSession\": true}\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:593:43)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
{"timestamp":"2025-10-03T22:11:26.215Z","suite":"Auth-security-comprehensive","testCase":"should log all authentication events securely","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m\"login_failure\"\u001b[39m, \u001b[32mObjectContaining {\"message\": StringContaining \"Failed login attempt for username: admin\", \"reason\": \"invalid_credentials\", \"userAgent\": \"Malicious-Bot/1.0\", \"username\": \"admin\"}\u001b[39m, \u001b[32m\"192.168.1.100\"\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:629:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
{"timestamp":"2025-10-03T22:11:26.219Z","suite":"Auth-security-comprehensive","testCase":"should sanitize audit logs to prevent log injection","error":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mjest.fn()\u001b[39m\u001b[2m).\u001b[22mtoHaveBeenCalledWith\u001b[2m(\u001b[22m\u001b[32m...expected\u001b[39m\u001b[2m)\u001b[22m\n\nExpected: \u001b[32m\"login_failure\"\u001b[39m, \u001b[32mObjectContaining {\"message\": StringContaining \"Failed login attempt for username: admin\", \"reason\": \"invalid_credentials\", \"userAgent\": \"Bot/1.0 [FAKE] Successful admin login\", \"username\": \"admin\"}\u001b[39m, \u001b[32m\"192.168.1.100\"\u001b[39m\n\nNumber of calls: \u001b[31m0\u001b[39m\n    at Object.toHaveBeenCalledWith (Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts:665:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","metadata":{"file":"Q:\\_kyle\\temp_documents\\GitHub\\business_scraper\\src\\__tests__\\security\\auth-security-comprehensive.test.ts","category":"assertion","severity":"medium","retryCount":0}}
